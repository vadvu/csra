<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Some functions that are used by CSRA staff in quantitative analysis of political events.">
<title>Analysis of count data • csra</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Analysis of count data">
<meta property="og:description" content="Some functions that are used by CSRA staff in quantitative analysis of political events.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">csra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/csra.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="csra">csra<a class="anchor" aria-label="anchor" href="#csra"></a>
</h1></div>
<ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#some-r-for-csra-studentsinterns">Some R for CSRA students/interns</a></li>
<li><a href="#example-1-equalparts">Example 1: <code>equalparts()</code></a></li>
<li><a href="#example-2-u_shape_test">Example 2: <code>U_shape_test()</code></a></li>
<li>
<a href="#some-additional-functions">Some additional functions</a>
<ul>
<li><a href="#goldstone-regime-type-classification">Goldstone regime type classification</a></li>
</ul>
</li>
</ul>
<!-- README.md is generated from README.Rmd. Please edit that file --><!-- badges: start --><!-- badges: end --><p>csra is a package with functions used by <a href="https://social.hse.ru/mr/" class="external-link">CSRA</a> staff to analyze political events.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of csra from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"vadvu/csra"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="some-r-for-csra-studentsinterns">Some R for CSRA students/interns<a class="anchor" aria-label="anchor" href="#some-r-for-csra-studentsinterns"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Rstudio <a href="https://ucdavis-bioinformatics-training.github.io/Oct2017-ILRI-Workshop/Cheat_Sheets/rstudio-IDE-cheatsheet.pdf" class="external-link">Cheatsheet</a>.<br>
</li>
<li>Good practical books/resources on statistics in R: <a href="https://book.stat420.org/" class="external-link">1</a>, <a href="https://stats.oarc.ucla.edu/other/dae/" class="external-link">2</a>, <a href="https://methodenlehre.github.io/intro-to-rstats/index.html" class="external-link">3</a>, <a href="https://murraylax.org/rtutorials/" class="external-link">4</a>.<br>
</li>
<li>Visualization in R: <a href="https://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html" class="external-link">1</a>, <a href="https://r-coder.com/r-graphs/" class="external-link">2</a>, <a href="https://r-statistics.co/ggplot2-Tutorial-With-R.html" class="external-link">3</a>. Also note extremely powerful package <a href="https://strengejacke.github.io/sjPlot/" class="external-link"><code>sjPlot</code></a> that provides you with regression tables, marginal effects, contingency tables and etc.</li>
</ol>
</div>
<div class="section level2">
<h2 id="example-1-equalparts">Example 1: <code>equalparts()</code>
<a class="anchor" aria-label="anchor" href="#example-1-equalparts"></a>
</h2>
<p>This is a basic example that shows you how the main (and really powerful) function <code><a href="reference/equalparts.html">equalparts()</a></code> works:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vadvu.github.io/csra/">csra</a></span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dataex"</span><span class="op">)</span> <span class="co">#it's an example panel "long" data that you can use</span></span>
<span></span>
<span><span class="co">#Now let's try to analyze how VDEM democracy index affects revolutionary situations</span></span>
<span><span class="fu"><a href="reference/equalparts.html">equalparts</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">datex</span>, <span class="co">#our data</span></span>
<span>  independent <span class="op">=</span> <span class="st">'VDEM_v2x_polyarchy'</span>, <span class="co">#independent var</span></span>
<span>  lag_independent <span class="op">=</span> <span class="cn">T</span>, <span class="co">#Should it be lagged? Yes, because political regime can change dramatically during revolutionary year</span></span>
<span>  lag_code <span class="op">=</span> <span class="st">"iso3"</span>, <span class="co">#by what unit lag is realized (object from country-year, in our case it is iso3 code)</span></span>
<span>  lead <span class="op">=</span> <span class="cn">T</span>, <span class="co">#due to data specific in the top we have earlier data - 2019, 2018, 2017, ..., so `lead` should be used. Otherwise, False is needed</span></span>
<span>  dependent <span class="op">=</span> <span class="st">'NVC_1.3_NONVIOL'</span>, <span class="co">#dependent var</span></span>
<span>  n <span class="op">=</span> <span class="fl">6</span>, <span class="co">#number of equal parts. If n = 10, it is decile analysis, 4 - quartile analysis and etc</span></span>
<span>  bar_or_scatter <span class="op">=</span> <span class="st">'scatter'</span>, <span class="co">#plot type, scatter is more powerful</span></span>
<span>  regline <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co">#linear regression line</span></span>
<span>  return_data <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#we want to see plot, so we do not need data</span></span>
<span>  conf_bars <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co">#95%CI</span></span>
<span>  range_bars <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#range (max-min) of independent var in each unit (for ex., decile)</span></span>
<span>  save_plot <span class="op">=</span> <span class="cn">FALSE</span> <span class="co">#we do not want to save plot, so its False</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="100%"></p>
<p>The note section is constructed as follows:<br>
1. Pearson’s r (note, <span class="math inline">$Cor(X,Y) = \frac{Cov(X,Y)}{\sqrt{D(X)D(Y)}}$</span> that measures <strong><em>linear</em></strong> association)<br>
2. Lower and higher bound of 95% CI of correlation coefficient are in square brackets<br>
3. p-value of a t-statistics that is in the brackets (so, it is <span class="math inline"><em>P</em>(|<em>t̂</em>|&gt;<em>t</em><sub>0.975</sub>(<em>n</em>−1))</span> ).<br>
4. <span class="math inline"><em>χ</em><sup>2</sup></span> statistics with stars indicating the <span class="math inline"><em>p</em> &lt; 0.01</span> level of significance (note, in this function <span class="math inline"><sup>* * *</sup><em>p</em> &lt; 0.01,<sup>**</sup><em>p</em> &lt; 0.05,<sup>*</sup><em>p</em> &lt; 0.1</span> ).</p>
<p>Plot that is returned by default can be easily changed by <a href="https://github.com/tidyverse/ggplot2/tree/main" class="external-link">ggplot2</a> syntax. Just save function output and add to it ggplot2 blocks:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vadvu.github.io/csra/">csra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"datex"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/equalparts.html">equalparts</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">datex</span>,</span>
<span>  independent <span class="op">=</span> <span class="st">'VDEM_v2x_polyarchy'</span>,</span>
<span>  lag_independent <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  lag_code <span class="op">=</span> <span class="st">"iso3"</span>,</span>
<span>  lead <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  dependent <span class="op">=</span> <span class="st">'NVC_1.3_NONVIOL'</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  bar_or_scatter <span class="op">=</span> <span class="st">'scatter'</span>,</span>
<span>  regline <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  conf_bars <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  range_bars <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_plot <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># for ex., change axis names and theme</span></span>
<span><span class="va">plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"x var name"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"y var name"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_grey</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<p>Also table with results can be returned, just set <code>return_data = TRUE</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vadvu.github.io/csra/">csra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"datex"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/equalparts.html">equalparts</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">datex</span>,</span>
<span>  independent <span class="op">=</span> <span class="st">'VDEM_v2x_polyarchy'</span>,</span>
<span>  lag_independent <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  lag_code <span class="op">=</span> <span class="st">"iso3"</span>,</span>
<span>  lead <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  dependent <span class="op">=</span> <span class="st">'NVC_1.3_NONVIOL'</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  bar_or_scatter <span class="op">=</span> <span class="st">'scatter'</span>,</span>
<span>  regline <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_data <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co">#here</span></span>
<span>  conf_bars <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  range_bars <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_plot <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    parts Freq_0 Freq_1      means   min   max  prc5 prc95     low95CI</span></span>
<span><span class="co">#&gt; 7      1   1592     21 0.09029262 0.008 0.145 0.016 0.143 0.007487174</span></span>
<span><span class="co">#&gt; 8      2   1583     30 0.17917483 0.145 0.214 0.149 0.210 0.012005542</span></span>
<span><span class="co">#&gt; 9      3   1565     48 0.28196590 0.214 0.362 0.220 0.354 0.021465775</span></span>
<span><span class="co">#&gt; 10     4   1551     62 0.47658215 0.362 0.600 0.372 0.588 0.029055460</span></span>
<span><span class="co">#&gt; 11     5   1578     35 0.71369994 0.601 0.814 0.613 0.801 0.014588331</span></span>
<span><span class="co">#&gt; 12     6   1605      7 0.86508437 0.814 0.926 0.820 0.907 0.001132506</span></span>
<span><span class="co">#&gt;       high95CI</span></span>
<span><span class="co">#&gt; 7  0.018551264</span></span>
<span><span class="co">#&gt; 8  0.025192226</span></span>
<span><span class="co">#&gt; 9  0.038050654</span></span>
<span><span class="co">#&gt; 10 0.047819928</span></span>
<span><span class="co">#&gt; 11 0.028809065</span></span>
<span><span class="co">#&gt; 12 0.007552358</span></span></code></pre></div>
<p>The columns in the table are:<br>
1. <code>parts</code> - equal subsample. In our case - sixtiles.<br>
2. <code>Freq_0</code> - number of observations with “0” values.<br>
3. <code>Freq_1</code> - number of observations with “1” values.<br>
4. <code>means</code> - mean of independent variable in specific interval (equal part).<br>
(scatter plot between <code>Freq_1</code> and <code>means</code> is the basic plot that is pictured earlier).<br>
5. <code>min</code> - min value of independent variable in specific interval (equal part).<br>
6. <code>max</code> - max value of independent variable in specific interval (equal part).<br>
7. <code>prc5</code> - 5 percentile value of independent variable in specific interval (equal part).<br>
8. <code>prc95</code> - 95 percentile value of independent variable in specific interval (equal part).<br>
9. <code>low95CI</code> - lower Wald 95% interval (2.5%). Wald CI are:<br><span class="math display">$$\hat{\pi} \pm z_{a/2}\times \sqrt{\frac{\hat{\pi}\times(1-\hat{\pi})}{n}}$$</span><br>
where <span class="math inline"><em>π̂</em></span> is an estimated probability, and <span class="math inline"><em>z</em><sub><em>a</em>/2</sub> = 1.96</span> due to 95% CI.<br>
10. <code>high95CI</code> - higher Wald 95% interval (97.5%).</p>
</div>
<div class="section level2">
<h2 id="example-2-u_shape_test">Example 2: <code>U_shape_test()</code>
<a class="anchor" aria-label="anchor" href="#example-2-u_shape_test"></a>
</h2>
<p>Another function (in the DEMO stage) is the <code><a href="reference/U_shape_test.html">U_shape_test()</a></code>, which aims to detect hump-shaped forms of links. Currently, only a rare events logistic model has been implemented, although the logic is suitable for all GLMs.<br>
What is U-shape? Simply put, it is the link between variables that is similar to parabola. Usually, it is modeled as polynomial term in the regression equitation, but it’s not the only one option. What is really important in the case of U-shape is that there is only one extreme point (as parabola has). Moreover, the slope of such curve should be positive (negative) on the interval <span class="math inline">[<em>x</em><sub><em>m</em><em>i</em><em>n</em></sub>,<em>x</em><sub><em>m</em><em>i</em><em>d</em><em>p</em><em>o</em><em>i</em><em>n</em><em>t</em></sub>]</span> and negative (positive) on the interval <span class="math inline">[<em>x</em><sub><em>m</em><em>i</em><em>d</em><em>p</em><em>o</em><em>i</em><em>n</em><em>t</em></sub>,<em>x</em><sub><em>m</em><em>a</em><em>x</em></sub>]</span>. Let’s say we have such equation:<br><span class="math display">$$y_i = \beta_0 + \beta_1\times x_i + \beta_2\times f(x_i) + \sum_{}^{} \beta_k \times z_{i,k} + \varepsilon_i$$</span><br>
where <span class="math inline"><em>β</em><sub><em>k</em></sub></span> are coefficients, <span class="math inline"><em>x</em></span> is our variable of interest which we assume has a U-shape relationship with <span class="math inline"><em>y</em></span> by this part of formula: <span class="math inline"><em>β</em><sub>1</sub> × <em>x</em><sub><em>i</em></sub> + <em>β</em><sub>2</sub> × <em>f</em>(<em>x</em><sub><em>i</em></sub>)</span>, <span class="math inline"><em>z</em><sub><em>k</em></sub></span> are control variables, <span class="math inline"><em>y</em></span> is our dependent variable and <span class="math inline"><em>ε</em></span> is a error term.<br>
Then by definition of the U-shape that described earlier, this inequality should be implied:<br><span class="math display"><em>β</em><sub>1</sub> + <em>β</em><sub>2</sub> × <em>f</em>′(<em>x</em><sub><em>i</em></sub>∈[<em>x</em><sub><em>m</em><em>i</em><em>n</em></sub>,<em>x</em><sub><em>m</em><em>i</em><em>d</em><em>p</em><em>o</em><em>i</em><em>n</em><em>t</em></sub>]) &lt; 0 &lt; <em>β</em><sub>1</sub> + <em>β</em><sub>2</sub> × <em>f</em>′(<em>x</em><sub><em>i</em></sub>∈[<em>x</em><sub><em>m</em><em>i</em><em>d</em><em>p</em><em>o</em><em>i</em><em>n</em><em>t</em></sub>,<em>x</em><sub><em>m</em><em>a</em><em>x</em></sub>])</span><br>
This condition can be reformulated as 2 hypotheses for subsampled models:<br><span class="math display">$$y_i = \beta_0 + \beta_{lower}\times x_i + \sum_{}^{} \beta_k \times z_{i,k} + \varepsilon_i, x \in [x_{min},x_{midpoint}] (1)$$</span><br>
and<br><span class="math display">$$y_i = \beta_0 + \beta_{higher}\times x_i + \sum_{}^{} \beta_k \times z_{i,k} + \varepsilon_i, x \in [x_{midpoint}, x_{max}] (2)$$</span><br>
And hypotheses are (for inverse U-shape):<br>
+ <span class="math inline"><em>H</em><sub><em>L</em></sub> : <em>β</em><sub><em>l</em><em>o</em><em>w</em><em>e</em><em>r</em></sub> &gt; 0</span>, for equitation 1<br>
+ <span class="math inline"><em>H</em><sub><em>H</em></sub> : <em>β</em><sub><em>h</em><em>i</em><em>g</em><em>h</em><em>e</em><em>r</em></sub> &lt; 0</span>, for equitation 2</p>
<p>This method in the function <code><a href="reference/U_shape_test.html">U_shape_test()</a></code> operates more complicated in the following way:<br>
1. The full model is estimated on a sample with a polynomial term. Let’s say it is:<br><span class="math display">$$y_i = \beta_0 + \beta_1\times x_i + \beta_2\times x_i^2 + \sum_{}^{} \beta_k \times z_{i,k} + \varepsilon_i$$</span> where <span class="math inline"><em>β</em><sub><em>k</em></sub></span> are coefficients, <span class="math inline"><em>x</em></span> is our variable of interest which we assume has a U-shape relationship with <span class="math inline"><em>y</em></span>, <span class="math inline"><em>z</em><sub><em>k</em></sub></span> are control variables, <span class="math inline"><em>y</em></span> is our dependent variable and <span class="math inline"><em>ε</em></span> is a error term.<br>
2. Divide the sample into two subsamples - the first being below the midpoint (which is identified as the vertex of the parabola from the polynomial term: <span class="math inline">$\frac{-\beta_1}{2\times \beta_2}$</span>), and the second being above it.<br>
3. Estimate two models on the two subsamples. A hump-shaped relationship assumes that there is both an ascending and a descending part. So, in order to test a hump, it is necessary to have significant positive and negative coefficients on the first and second subsample respectively.<br>
4. A semiparametric model is estimated without assumptions about the form of the link. The GAM method is used for this purpose. The variable of interest is modelled as a smooth term using cubic splines while other variables are modelled using parametric regressions. In our case it is:<br><span class="math display">$$y_i = \beta_0 + f(x_i) + \sum_{}^{} \beta_k \times z_{i,k} + \varepsilon_i$$</span> where <span class="math inline"><em>f</em>(<em>x</em><sub><em>i</em></sub>)</span> is a smooth term.<br>
5. ANOVA test between the model with a polynomial term (1st step) and GAM model (4th step). This test is needed to identify whether the polynomial term provides a better or not worse fit than the link found by the GAM splines. If <span class="math inline"><em>p</em> &gt; 0.1</span>, then the polynomial is considered a good approximation.<br>
6. Bootstrap of a midpoint (<span class="math inline">$\frac{-\beta_1}{2\times \beta_2}$</span>) for constructing CI. This is optional, but highly recommended stage. Now it works unstable in the function…<br>
7. This is the final stage.<br><strong>IF</strong> the polynomial term is significant (1st stage) <strong>AND</strong> there are significant opposite signs on subsamples (2nd stage), <strong>AND</strong> the GAM term is significant in terms of EDF significance (4th stage), <strong>AND</strong> the ANOVA test’s p-value is greater than 0.1 (5th stage), <strong>THEN</strong> there exists a hump-shaped or U-shaped link between the variables. In this case, the polynomial term is suitable for approximating such a relationship.</p>
<p>This approach is based on 2 papers that define the overall strategy for identifying a U-shaped relationship with continuous data (i.e. with a linear regression model):<br>
- Lind, J. T., &amp; Mehlum, H. (2010). With or without U? The appropriate test for a U‐shaped relationship. Oxford bulletin of economics and statistics, 72(1), 109-118.<br>
- Simonsohn, U. (2018). Two lines: A valid alternative to the invalid testing of U-shaped relationships with quadratic regressions. Advances in Methods and Practices in Psychological Science, 1(4), 538-555.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vadvu.github.io/csra/">csra</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"datex"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/U_shape_test.html">U_shape_test</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">datex</span>, <span class="co">#our data</span></span>
<span>  dep <span class="op">=</span> <span class="st">"NVC_1.3_NONVIOL"</span>, <span class="co">#dependent variable</span></span>
<span>  ind <span class="op">=</span> <span class="st">"VDEM_v2x_polyarchy_lag"</span>, <span class="co">#independent var</span></span>
<span>  cnt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UN_Median_Age"</span>, <span class="st">"UN_Total_Population_log"</span><span class="op">)</span>, <span class="co">#control vars</span></span>
<span>  boot <span class="op">=</span> <span class="st">"none"</span>, <span class="co">#bootstrap for middle point analysis - we do not use it in an example </span></span>
<span>  n <span class="op">=</span> <span class="fl">1000</span>, <span class="co">#number of bootstrap deaws</span></span>
<span>  const <span class="op">=</span> <span class="cn">T</span>, <span class="co">#We need constan in a model</span></span>
<span>  HC <span class="op">=</span> <span class="cn">T</span>, <span class="co">#type of SE</span></span>
<span>  plot <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  tab_save <span class="op">=</span> <span class="cn">FALSE</span> <span class="co">#we do not need to save regression table</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ======================================================</span></span>
<span><span class="co">#&gt;                                Dependent variable:    </span></span>
<span><span class="co">#&gt;                            ---------------------------</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt; ------------------------------------------------------</span></span>
<span><span class="co">#&gt; VDEM_v2x_polyarchy_lag              8.544***          </span></span>
<span><span class="co">#&gt;                                      (1.328)          </span></span>
<span><span class="co">#&gt; I(VDEM_v2x_polyarchy_lag2)         -10.989***         </span></span>
<span><span class="co">#&gt;                                      (1.461)          </span></span>
<span><span class="co">#&gt; UN_Median_Age                       0.044***          </span></span>
<span><span class="co">#&gt;                                      (0.011)          </span></span>
<span><span class="co">#&gt; UN_Total_Population_log             0.351***          </span></span>
<span><span class="co">#&gt;                                      (0.045)          </span></span>
<span><span class="co">#&gt; Constant                            -8.941***         </span></span>
<span><span class="co">#&gt;                                      (0.519)          </span></span>
<span><span class="co">#&gt; ------------------------------------------------------</span></span>
<span><span class="co">#&gt; N                                     8400            </span></span>
<span><span class="co">#&gt; AIC                                  1768.79          </span></span>
<span><span class="co">#&gt; U-shape test:                                         </span></span>
<span><span class="co">#&gt; Extremum                              0.39            </span></span>
<span><span class="co">#&gt; Xlower                          2.49 (p = 0.0065)     </span></span>
<span><span class="co">#&gt; Xhigher                           -5.62 (p = 0)       </span></span>
<span><span class="co">#&gt; GAM edf                           3.16 (p = 0)        </span></span>
<span><span class="co">#&gt; AIC glm - AIC gam                     -2.84           </span></span>
<span><span class="co">#&gt; ======================================================</span></span>
<span><span class="co">#&gt; Note:                      *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="some-additional-functions">Some additional functions<a class="anchor" aria-label="anchor" href="#some-additional-functions"></a>
</h2>
<div class="section level3">
<h3 id="goldstone-regime-type-classification">Goldstone regime type classification<a class="anchor" aria-label="anchor" href="#goldstone-regime-type-classification"></a>
</h3>
<p>Goldstone et al. (<a href="https://doi.org/10.1111/j.1540-5907.2009.00426.x" class="external-link">2010</a>) proposed new regime type classification that is based on Polity-V project. This approach distinguishes five types of political regimes based on two indicators of the Polity database – EXREC (Executive Recruitment) and PARCOMP (Competitiveness of Political Participation). Function <code>goldclass</code> provide you with ability to recode Polity-V data into 5-class variable:<br>
1. full autocracy<br>
2. partial autocracy<br>
3. partial democracy<br>
4. partial democracy with factionalism<br>
5. full democracy</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">polity5data</span><span class="op">$</span><span class="va">goldstone_regime</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/goldclass.html">goldclass</a></span><span class="op">(</span>exrec <span class="op">=</span> <span class="va">polity5data</span><span class="op">$</span><span class="va">exrec</span>, parcomp <span class="op">=</span> <span class="va">polity5data</span><span class="op">$</span><span class="va">parcomp</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing csra</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Vadim Ustyuzhanin <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-3800-1108" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Vadim Ustyuzhanin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
